<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="icon" type="image/x-icon" href="../assets/favicon.png">

    <title>Crypto App</title>
</head>

<body class="d-flex flex-column min-vh-100">

<nav class="navbar navbar-expand-lg navbar navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="index.html">Crypto App</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Historic Context
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="definition.html">Definition</a></li>
                            <li><a class="dropdown-item" href="egypt.html">Egypt</a></li>
                            <li><a class="dropdown-item" href="old.html">Old Testament</a></li>
                            <li><a class="dropdown-item" href="kamasutra.html">Kama Sutra</a></li>
                            <li><a class="dropdown-item" href="arabia.html">Arabia</a></li>
                            <li><a class="dropdown-item" href="sparta.html">Sparta</a></li>
                            <li><a class="dropdown-item" href="wars.html">World Wars</a></li>
                            <li><a class="dropdown-item" href="new.html">New Applications</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Classic Crypto-Systems
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="displacement.html">Displacement</a></li>
                            <li><a class="dropdown-item" href="substitution.html">Substitution</a></li>
                            <li><a class="dropdown-item" href="permutation.html">Permutation</a></li>
                            <li><a class="dropdown-item" href="affine.html">Affine</a></li>
                            <li><a class="dropdown-item" href="vigenere.html">Vigenere</a></li>
                            <li><a class="dropdown-item" href="hill.html">Hill</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Cipher Analysis
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="displacementAnalysis.html">Displacement Analysis</a></li>
                            <li><a class="dropdown-item" href="substitutionAnalysis.html">Substitution Analysis</a></li>
                            <li><a class="dropdown-item" href="vigenereAnalysis.html">Vigenere Analysis</a></li>
                            <li><a class="dropdown-item" href="affineAnalysis.html">Affine Analysis</a></li>
                            <li><a class="dropdown-item" href="hillAnalysis.html">Hill Analysis</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Block Ciphers
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="des.html">DES</a></li>
                            <li><a class="dropdown-item" href="3des.html">3-DES</a></li>
                            <li><a class="dropdown-item" href="sdes.html">S-DES</a></li>
                            <li><a class="dropdown-item" href="aes.html">AES</a></li>
                            <li><a class="dropdown-item" href="gammaPentagonal.html">Gamma Pentagonal</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Public Key Cyphers
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="rsa.html">RSA</a></li>
                            <li><a class="dropdown-item" href="elGamal.html">ElGamal</a></li>
                            <li><a class="dropdown-item" href="rabin.html">Rabin</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Signature Schemes
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="rsasignature.html">RSA</a></li>
                            <li><a class="dropdown-item" href="elgammalsignature.html">ElGamal</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="aboutUs.html" aria-current="page">About us</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
        <h1 class="mt-3 text-center">ElGamal Cipher</h1>
    </div>
    <div class="row">
        <div class="col card container mt-3">
            <div class="card-body">
                <h3 class="card-title text-center mb-4">Encrypt</h3>
                <div class="row">
                    <form id="myForm">
                        <div class="mb-3">
                            <label for="inputTextEncrypt" class="form-label">Text</label>
                            <input type="text" class="form-control" id="inputTextEncrypt"
                                   aria-describedby="textHelp" style="text-transform:uppercase">
                            <div id="textHelp" class="form-text">Please introduce some text to encrypt.</div>
                        </div>
                        <div class="text-center">
                            <button id="submitButtonEncrypt" type="button"
                                    class="btn btn-primary justify-content-center">Encrypt
                            </button>
                        </div>
                    </form>
                </div>
                <div id="encryptionResultsDiv" class="row mt-5" style="display: none;">
                    <hr>
                    <h4 class="card-subtitle mt-2 mb-4 text-center">Results</h4>
                    <p><b>Encryption: </b><span id="cardEncryptionText"></span></p>
                    <p><b>Key Used: </b><span id="cardEncryptionKey"></span></p>
                </div>
            </div>
        </div>


        <div class="col card container mt-3">
            <div class="card-body">
                <h3 class="card-title text-center mb-4">Decrypt</h3>
                <div class="row">
                    <form id="myForm">
                        <div class="mb-3">
                            <label for="inputTextDecrypt" class="form-label">Text</label>
                            <input type="text" class="form-control" id="inputTextDecrypt"
                                   aria-describedby="textHelp" style="text-transform:uppercase">
                            <div id="textHelp" class="form-text">Please introduce the text to decrypt.</div>
                        </div>
                        <div class="mb-3">
                            <label for="inputKeyDecrypt" class="form-label">Key</label>
                            <input type="text" class="form-control" id="inputKeyDecrypt" aria-describedby="keyHelp"
                                   style="text-transform:uppercase">
                            <div id="keyHelp" class="form-text">Please introduce the key.</div>
                        </div>
                        <div class="text-center">

                            <button id="submitButtonDecrypt" type="button"
                                    class="btn btn-primary justify-content-center">Decrypt
                            </button>
                        </div>
                    </form>
                </div>
                <div id="decryptionResultsDiv" class="row mt-5" style="display: none;">
                    <hr>
                    <h4 class="card-subtitle mt-2 mb-4 text-center">Results</h4>
                    <p><b>Decryption: </b><span id="cardDecryptionText"></span></p>
                    <p><b>Key Used: </b><span id="cardDecryptionKey"></span></p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Explanation</h5>
                <h6 class="card-subtitle mb-2 text-muted">How does this work?</h6>
                <p>The ElGammal cryptographic system, named after its creator Taher Elgammal who described the method in 1984, is an asymmetric key cryptographic system and broadly works in the same way as the RSA cryptosystem. In this case we define it as follows:</p>
                <p>Let <span class="math inline"><em>p</em></span> be a prime such that the discrete logarithm problem in <span class="math inline">(ℤ<sub><em>n</em></sub><sup>*</sup>,⋅)</span> is infeasible to solve, <span class="math inline"><em>α</em> ∈ ℤ<sub><em>n</em></sub><sup>*</sup></span> a primitive element, <span class="math inline">𝒫 = ℤ<sub><em>n</em></sub><sup>*</sup></span> and <span class="math inline">𝒞 = ℤ<sub><em>n</em></sub><sup>*</sup> × ℤ<sub><em>n</em></sub><sup>*</sup></span> we define the set of keys <span class="math inline">𝒦</span> as 
                    <p class="text-center"><span
                        class="math display">𝒦 = { (<em>p</em>,<em>α</em>,<em>a</em>,<em>β</em>) : <em>β</em>≡<em>α</em><sup><em>a</em></sup> mod  <em>p</em>}</span></p>
                    The values <span class="math inline"><em>p</em></span>, <span class="math inline"><em>α</em></span> and <span class="math inline"><em>β</em></span> are the public key and <span class="math inline"><em>a</em></span> is the private key. For <span class="math inline"><em>K</em> = (<em>p</em>,<em>α</em>,<em>a</em>,<em>β</em>)</span> and a secret random number <span class="math inline"><em>k</em> ∈ ℤ<sub><em>n</em></sub><sup>*</sup></span>, we define</p> 
                    <p class="text-center"><span class="math display"><em>e</em><sub><em>K</em></sub>(<em>x</em>,<em>k</em>) = (<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>)</span></p>
                    where 
                    <p class="text-center"><span class="math display"><em>y</em><sub>1</sub> = <em>α</em><sup><em>k</em></sup> mod  <em>p</em>      <em>y</em><sub>2</sub> = <em>x</em><em>β</em><sup><em>k</em></sup> mod  <em>p</em></span></p>
                    for <span class="math inline"><em>y</em><sub>1</sub>, <em>y</em><sub>2</sub> ∈ ℤ<sub><em>n</em></sub><sup>*</sup></span> we will define 
                    <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub> ( <em>y</em><sub>1</sub>, <em>y</em><sub>2</sub> ) = <em>y</em><sub>2</sub> (<em>y</em><sub>1</sub><sup><em>a</em></sup>) <sup>−1</sup> mod  <em>p</em></span></p>
                <br>
                <p><strong>Example.</strong> Let’s encrypt the plaintext in numbers 348754, we randomly generate <span class="math inline"><em>p</em> = 549607 &gt; <em>x</em></span>, <span class="math inline"><em>a</em><em>l</em><em>p</em><em>h</em><em>a</em> = 11</span> and <span class="math inline"><em>a</em> = 728398</span>. We now calculate <span class="math inline"><em>b</em><em>e</em><em>t</em><em>a</em></span> as follows: 
                <p class="text-center"><span class="math display"><em>β</em> = <em>α</em><sup><em>a</em></sup> mod  <em>p</em> = 11<sup>728398</sup> mod  549607 = 436137</span></p>
                So the public key is <span class="math inline">(549607,11,436137)</span>. Now we choose a secret random number <span class="math inline"><em>k</em> ∈ ℤ<sub><em>n</em></sub><sup>*</sup></span> such that <span class="math inline">2 ≤ <em>k</em> ≤ <em>p</em> − 1</span>, in this case we do <span class="math inline"><em>k</em> = 794</span>, so that </p>
                <p class="text-center"><span class="math display">y<sub>1</sub>=α<sup><em>k</em></sup> mod <em>p</em>=11<sup>794</sup>=58468</span></p> 
                <p class="text-center"><span class="math display">y<sub>2</sub>=<em>x</em> <em>β</em><sup><em>k</em></sup>=(348754)(436137)<sup>794</sup>=35325</span></p>
                Thus the ciphertext is <span class="math inline">(58468,35325)</span>.</p>
                <p>To decipher we do: 
                    
                <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub>(<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>) = <em>y</em><sub>2</sub>(<em>y</em><sub>1</sub><sup><em>a</em></sup>)<sup>−1</sup> mod  <em>p</em></span></p>
                <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub>(<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>) = 35325((58468)<sup>728398</sup>)<sup>−1</sup> mod  549607</span></p>
                <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub>(<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>) = 35325(496141)<sup>−1</sup> mod  549607</span></p>
                <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub>(<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>) = 35325 * 280889 mod  549607</span></p>
                <p class="text-center"><span class="math display"><em>d</em><sub><em>K</em></sub>(<em>y</em><sub>1</sub>,<em>y</em><sub>2</sub>) = 348754</span></p>
                </span> Which in effect is the text <span class="math inline"><em>x</em></span> that we encrypted in the first part of the example.</p>

                <p class="card-text">

                </p>


            </div>
        </div>
    </div>
</div>

<div class="mt-5"></div>

<footer class="bg-light text-center text-lg-start mt-auto">
    <!-- Copyright -->
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        © 2021 Copyright
    </div>
    <!-- Copyright -->
</footer>

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

<script algorithm="el_gamal" src="../scripts/script.js"></script>

</body>

</html>